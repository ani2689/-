# 웹 프로그램의 동작

웹 프로그램을 개발한다는 것은 서버에서 동작하며 기능을 제공하는 여러가지 컴포넌트를 만드는 일이다.

회원가입 컨포넌트, 로그인 컴포넌트 등을 예로 들 수 있다.

이렇게 서버에 존재하는 웹 컨포넌트 스스로는 동작하지 못한다. 이를 호출해주는 무언가가 있어야 한다. 그 역할을 하는 것이 웹 클라이언트이다.

웹 클라이언트가 요청을 주면 웹 컨포넌트가 이에 응답하는 방식으로 웹 프로그램이 동작한다.

웹 컨포넌트의 주 목적은 결국 다이나믹 콘텐츠의 생산으로, 정적이 아닌 동적으로 웹 클라이언트에 응답한다.

하지만 웹 컨포넌트는 홀로 있을 수 없다. 웹 컨포넌트는 웹 컨테이너 안에 들어가있어야 한다.

## 웹 컨테이너

웹 컨테이너는 뭘까? 웹 컨포넌트는 서버에 위치한다. 컴포넌트를 메모리에 올리고... 새로운 인스턴스를 생성하고... 서비스가 실행되는 동안 웹 컴포넌트가 동작하도록 관리해주는 작업이 필요하다. 흔히 이야기하는 라이프 사이클, 생명주기를 관리하는 작업을 웹 컨테이너가 수행한다.

하나 더, 일반적으로 웹 컨테이너는 하나의 웹 컴포넌트만을 가지지 않는다. 각각의 역할을 가진 다수의 웹 컨포넌트를 동시에 갖는다. 웹 컨테이너는 웹 클라이언트에 요청에 따라 웹 컨포넌트를 매칭시켜주는 작업도 수행한다.

어떤 웹 컴포넌트가 웹 요청을 처리할 지 결정하는 것을 라우팅 또는 웹 매핑이라고 한다. 

## 자바에서는?

지금까지 웹 컨포넌트, 웹 컨테이너라는 용어를 사용했는데 자바에서 같은 역할을 하는 것이 무엇일까?

웹 컨포넌트는 Servlet, 서블릿이 웹 컨포넌트이고 웹 컨포넌트는 Servlet Container, 즉 서블릿 컨테이너라고 부른다.

서블릿 컨테이너의 예를 들자면 톰캣 등이 있다.

서블릿 컨테이너 안에 서블릿을 여러개 띄워놓고 매핑 정보를 넣어놓으면 요청에 따라 특정 서블릿이 그 요청을 처리하고 응답이 생성되면 그 정보를 서블릿 컨테이너가 클라이언트에게 반환한다. 

이게 전통적인 90년대 후반부터 시작된 자바의 웹 프로그래밍 기본 구성이다. (으악)

이런 에튼서블릿에 대해 불만을 가진 사람들이 만든 것 중 하나가 스프링 프레임워크.

# 스프링은 뭐지?

스프링 또한 컨테이너이다. 서블릿 컨테이너를 대체하는 건가 싶겠지만 아니다. 스프링 컨테이너느 뒤에 존재하며, 서블릿 컨테이너와 같이 웹 컨포넌트를 가진다. 스프링 컨테이너에 들어가는 컨포넌트는 흔히 빈이라고 부른다. 

스프링 컨테이너는 서블릿 컨테니어 뒤쪽에 위치하여 서블릿이 웹으로부터의 요청을 받아오면 스프링 컨테이너로 넘기는데, 그에 따라 호출 된 빈이 다른 빈을 호출하고, 그 연쇄 작용으로 스프링 안에서 개발자가 작성한 애플리케이션이 동작하는 것이다.

## 스프링 컨테이너가 서블릭 컨테이너를 대체하면

귀찮으니까 그냥 스프링 컨테이너가 서블릭 컨테이너를 대체하면 안될까?

자바의 표준 웹 기술을 사용하려면, 어쨌건 서블릭 컨테이너가 존재해야 한다.

문제는 개발자가 웹 애플리케이션을 개발하는 것에만 집중할 수가 없다는 것이다. 가장 간단한 헬로월드 서버 조차도 서블릿 컨테이너가 필요하다. 하지만 이 서블릿 컨테이너를 띄우는 건 어려운 일이다.

오래된 기술이기도 하고 많은 기술을 포용하려고 하기에 여러 가지의 다양한 설정 방법을 요구하고 있다.

기본적으로 web.xml 을 작성해야 한다. 작성 후에야 서블릿 컨테이너가 작동하고 그 서블릿 컨테이너를 통해서 스프링 컨테이너가 호출이 되는 것이다.

또 스프링 웹 애플리케이션을 처음 구축할 때만 건드리고 후에는 만지지도 않는다.

web.xml을 작성했다고 끝이 아니다.(웩) 서블릿 컨테이너와 스프링 컨테이너를 아우르는 모든 애플리케이션은 war, 웹 애플리케이션 아카이브라고 불리는 형식의 파일로 빌드가 되어야 한다.

이뿐만이 아니다! 폴더 구조도 중요하다. web-inf, jar 라이브러리 위치 등의 정보도 계속 신경을 써주어야 한다.

더있다! 서블릿 컨테이너는 완전히 독립적인 실행환경이다. 개발을 끝냈더라도 우리는 톰캣과 같은 프로그램을 받아와 설치 후 실행을 시켜야 된다. 그리고 war 파일로 압축되어 있는 서블릿 애플리케이션을 배포하는 작업도 해야한다.

여기서도 문제가 여럿 발생한다. 배포가 안된다는 둥, 충돌이 난다는 둥. 그런 류의 문제를 모두 해결할 줄 알아야 한다. 그뿐이 아닌 서블릿 컨테이너에도 여러가지 설정해야 하는 게 굉장히 많다.

또! 서블릿 컨테이너는 표준 스펙이고, 그걸 구현한 제품을 가져다 사용해야하는데 프로젝트 마다 필요한게 또 다르고, 그 환경을 준비해야 하고 새로 배워야 할게 너무 많다.

개발하는 동안에 신경써야 되는게 아닌 이런 설정에 많은 시간과 노력을 할애해야 하는게 번거롭고, 내용을 모두 알아야 하는 것까지 보면 진입장벽이 너무 높다.

# 컨테이너리스 웹 아키텍처

서블릿 컨테이너의 존재는 꼭 필요하지만 이걸 개발자가 설치, 관리하고 신경쓰기 위해 시간을 들여야 하는가. 수고를 좀 덜어주었으면 좋겠다.

스프링부트는 컨테이너리스를 적용했다. 실제로는 서블릿 컨테이너가 동작하고, web.xml 등의 서버 설정이 스프링 부트를 통해 제공이 된다.

나중에 개발을 하다가 필요하다면 원하는 방식으로 이 아이를 튜닝 및 커스터마이징 할 수 있다. 

개발자는 개발에 집중할 수 있게 된 것이다.